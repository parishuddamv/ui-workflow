<div class="task-form-container">
  <h3 id="form-title">Create Task</h3>
  <form 
    (ngSubmit)="save()" 
    #taskForm="ngForm" 
    class="task-form grid-form" 
    aria-labelledby="form-title"
    role="form"
  >
    <!-- Row 1: Client, Task Name, Status -->
    <div class="form-group">
      <label for="clientId">Client</label>
      <select 
        id="clientId" 
        [(ngModel)]="clientId" 
        name="clientId" 
        required 
        aria-required="true"
      >
        <option value="" disabled selected>Select a client</option>
        <option *ngFor="let client of clients" [value]="client.id">{{ client.name }}</option>
      </select>
    </div>
    <div class="form-group">
      <label for="name">Task Name</label>
      <input 
        id="name" 
        [(ngModel)]="name" 
        name="name" 
        required 
        aria-required="true"
        placeholder="Enter task name"
      />
    </div>
    <div class="form-group">
      <label for="status">Status</label>
      <select 
        id="status" 
        [(ngModel)]="status" 
        name="status" 
        aria-required="true"
      >
        <option value="" disabled selected>Select status</option>
        <option value="Open">Open</option>
        <option value="InProgress">In Progress</option>
        <option value="Closed">Closed</option>
      </select>
    </div>

    <!-- Row 2: Assign To, Assign Date, Attachments -->
    <div class="form-group">
      <label for="assignedTo">Assign To</label>
      <input 
        id="assignedTo" 
        [(ngModel)]="assignedTo" 
        name="assignedTo" 
        required 
        aria-required="true"
        placeholder="Enter assignee name"
      />
    </div>
    <div class="form-group">
      <label for="assignDate">Assign Date</label>
      <input 
        id="assignDate" 
        [(ngModel)]="assignDate" 
        name="assignDate" 
        type="date" 
        required 
        aria-required="true"
      />
    </div>
    <div class="form-group">
      <label for="fileInput">Attachments</label>
      <div 
        class="dropzone"
        (drop)="onDrop($event)"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        [class.dragover]="isDragOver"
        (click)="fileInput.click()"
        role="region"
        aria-label="File upload dropzone"
      >
        <p>Drag & drop files here or click to select</p>
        <input 
          type="file" 
          id="fileInput" 
          multiple 
          (change)="onFileChange($event)" 
          #fileInput 
          hidden 
          aria-hidden="true"
        />
      </div>

      <div class="file-list" *ngIf="files.length > 0" role="list">
        <div class="file-item" *ngFor="let file of files; let i = index" role="listitem">
          <span>{{ file.name }} ({{ formatSize(file.size) }})</span>
          <button 
            type="button" 
            class="small-btn" 
            (click)="removeFile(i)"
            [attr.aria-label]="'Remove ' + file.name"
          >Remove</button>
        </div>
      </div>
    </div>

    <!-- Row 3: Description (full width) -->
    <div class="form-group full-width">
      <label for="description">Description</label>
      <textarea 
        id="description" 
        [(ngModel)]="description" 
        name="description"
        placeholder="Enter task description"
        aria-describedby="description-help"
      ></textarea>
      <small id="description-help" class="form-help">Optional: Add details about the task</small>
    </div>

    <!-- Buttons -->
    <div class="form-buttons full-width">
      <button 
        type="submit" 
        class="btn" 
        [disabled]="taskForm.invalid"
        aria-label="Create task"
      >Create Task</button>
      <button 
        type="button" 
        class="btn reset-btn" 
        (click)="resetForm()"
        aria-label="Reset form"
      >Reset</button>
    </div>
  </form>
</div>